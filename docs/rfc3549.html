<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.11.dev">
<title>RFC 3549</title>
<style>
@import url(https://fonts.googleapis.com/css?family=Varela+Round|Open+Sans:400italic,600italic,400,600|Ubuntu+Mono:400);
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: #fefdfd; color: rgba(0, 0, 0, 0.8); padding: 0; margin: 0; font-family: "Open Sans", sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.stretch { width: 100%; }

p.lead { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.25; color: #002c5e; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #005580; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #078d71; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Varela Round", sans-serif; font-weight: 400; font-style: normal; color: #00326b; text-rendering: optimizeLegibility; margin-top: 0.8em; margin-bottom: 0.5em; line-height: 1.0625em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #057aff; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid rgba(145, 135, 84, 0.15); border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Ubuntu Mono", "Inconsolata", monospace; font-weight: 400; color: #331d00; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: rgba(0, 0, 0, 0.8); border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #666666; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #666666; }

blockquote, blockquote p { line-height: 1.5; color: #999999; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.25; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px rgba(145, 135, 84, 0.15); }
table thead, table tfoot { background: rgba(119, 84, 22, 0.1); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: rgba(119, 84, 22, 0.025); }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.5; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.25; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

:not(pre):not([class^=L]) > code { font-size: 1.0625em; font-style: normal !important; letter-spacing: 0; padding: 0; line-height: 1.25; word-wrap: break-word; }

:not(pre) > code.nobreak { word-wrap: normal; }
:not(pre) > code.nowrap { white-space: nowrap; }

pre { color: inherit; font-family: "Liberation Mono", "Consolas", monospace; line-height: 1.4; }
pre code, pre pre { color: inherit; font-size: inherit; line-height: inherit; }
pre > code { display: block; }

pre.nowrap, pre.nowrap pre { white-space: pre; word-wrap: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { font-family: "Ubuntu Mono", "Inconsolata", monospace; display: inline-block; color: rgba(0, 0, 0, 0.8); font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: #1a0f00; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: #703f1c; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid rgba(145, 135, 84, 0.15); }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid rgba(145, 135, 84, 0.15); padding-bottom: 8px; }
#header .details { border-bottom: 1px solid rgba(145, 135, 84, 0.15); line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #666666; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #999999; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #999999; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: #703f1c; border-bottom: 1px solid rgba(145, 135, 84, 0.15); padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 0px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Varela Round", sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #002c5e; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background: #f2f2f4; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d6d6dd; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f4; -webkit-border-radius: 6px; border-radius: 6px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background: #0b445a; padding: 1.25em; }

#footer-text { color: #fefdfd; line-height: 1.35; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 0px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #00326b; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #002652; }

details, .audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

details > summary:first-of-type { cursor: pointer; display: list-item; outline: none; margin-bottom: 0.75em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock.fit-content > caption.title { white-space: nowrap; width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: 1.21875em; line-height: 1.6; color: #703f1c; }

table.tableblock #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Varela Round", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid rgba(145, 135, 84, 0.15); color: #666666; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #eddbdb; margin-bottom: 1.25em; padding: 1.25em; background: #fefdfd; -webkit-border-radius: 6px; border-radius: 6px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d1d1d8; margin-bottom: 1.25em; padding: 1.25em; background: #ececef; -webkit-border-radius: 6px; border-radius: 6px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #002c5e; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock > .content > pre { border: 1px solid rgba(16, 195, 196, 0.125); -webkit-border-radius: 6px; border-radius: 6px; word-wrap: break-word; overflow-x: auto; padding: 1em; font-size: 0.8125em; }
@media only screen and (min-width: 768px) { .literalblock pre, .listingblock > .content > pre { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .listingblock > .content > pre { font-size: 1em; } }

.literalblock pre, .listingblock > .content > pre:not(.highlight), .listingblock > .content > pre[class="highlight"], .listingblock > .content > pre[class^="highlight "] { background: rgba(16, 195, 196, 0.05); }

.literalblock.output pre { color: rgba(16, 195, 196, 0.05); background-color: inherit; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: inherit; opacity: 0.5; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: inherit; opacity: 0.5; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 6px; border-radius: 6px; }

.prettyprint { background: rgba(16, 195, 196, 0.05); }

pre.prettyprint .linenums { line-height: 1.4; margin-left: 2em; }

pre.prettyprint li { background: none; list-style-type: inherit; padding-left: 0; }

pre.prettyprint li code[data-lang]:before { opacity: 1; }

pre.prettyprint li:not(:first-child) code[data-lang]:before { display: none; }

table.linenotable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }
table.linenotable td[class] { color: inherit; vertical-align: top; padding: 0; line-height: inherit; white-space: normal; }
table.linenotable td.code { padding-left: 0.75em; }
table.linenotable td.linenos { border-right: 1px solid currentColor; opacity: 0.35; padding-right: 0.5em; }

pre.pygments .lineno { border-right: 1px solid currentColor; opacity: 0.35; display: inline-block; margin-right: 0.75em; }
pre.pygments .lineno:before { content: ""; margin-right: -0.125em; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock:not(.excerpt) > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock p { color: #999999; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #002c5e; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.75em; margin-right: 0.5ex; text-align: right; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #999999; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #666666; }

.quoteblock.abstract blockquote:before, .quoteblock.excerpt blockquote:before, .quoteblock .quoteblock blockquote:before { display: none; }
.quoteblock.abstract blockquote, .quoteblock.abstract p, .quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p { line-height: 1.6; word-spacing: 0; }
.quoteblock.abstract { margin: 0 1em 1.25em 1em; display: block; }
.quoteblock.abstract > .title { margin: 0 0 0.375em 0; font-size: 1.15em; text-align: center; }
.quoteblock.excerpt > blockquote, .quoteblock .quoteblock { padding: 0 0 0.25em 1em; border-left: 0.25em solid rgba(145, 135, 84, 0.15); }
.quoteblock.excerpt, .quoteblock .quoteblock { margin-left: 0; }
.quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p { color: inherit; font-size: 1.0625rem; }
.quoteblock.excerpt .attribution, .quoteblock .quoteblock .attribution { color: inherit; text-align: left; margin-right: 0; }

table.tableblock { max-width: 100%; border-collapse: separate; }

p.tableblock:last-child { margin-bottom: 0; }

td.tableblock > .content > :last-child { margin-bottom: -1.25em; }
td.tableblock > .content > :last-child.sidebarblock { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid rgba(145, 135, 84, 0.15); }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot, table.frame-ends { border-width: 1px 0; }

table.stripes-all tr, table.stripes-odd tr:nth-of-type(odd), table.stripes-even tr:nth-of-type(even), table.stripes-hover tr:hover { background: rgba(119, 84, 22, 0.025); }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.5; background: rgba(119, 84, 22, 0.1); }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: rgba(0, 0, 0, 0.8); font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.625em -1.25em; }

ul.inline > li { margin-left: 1.25em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist td:not([class]):first-child { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist td:not([class]):first-child img { max-width: none; }
.colist td:not([class]):last-child { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #004060; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: rgba(0, 0, 0, 0.8); -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.rfc-error pre, .listingblock pre { background: rgba(255, 187, 204, 0.4); border-color: #aaaaaa; }

.rfc-error-text { background-color: rgba(255, 187, 204, 0.4); }

#toc.toc2 ul ul { list-style-type: circle; padding-left: 2em; }

.sect1 { padding-bottom: 0 !important; margin-bottom: 2.5em; }

#header h1 { font-weight: bold; position: relative; left: -0.0625em; }

#content h2, #content h3, #content #toctitle, #content .sidebarblock > .content > .title, #content h4, #content h5, #content #toctitle { position: relative; left: -0.0625em; }
#content h2 { font-weight: bold; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

pre.pygments.highlight { background-color: rgba(16, 195, 196, 0.05); }

.pygments .tok-err { border: none !important; color: #800000 !important; }

.pygments .tok-c { color: #999 !important; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158925429-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158925429-1');
</script>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/cferdinandi/gumshoe@5/dist/gumshoe.polyfills.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.js"></script>
<script>
   jQuery(function () {
      var scrollspy = new Gumshoe('#toc li > a', {
         nested: false
      });
      document.addEventListener('gumshoeActivate', function (event) {
         jQuery('#toc')
            .stop()
            .scrollTo(event.detail.link, 500, {
               offset: {
                  top:  0 - jQuery('#toc').height() / 2,
                  left: 0,
               }
            });
      }, false);
   });
</script>

<style>
   #toc li.active > a {
      font-weight: bold;
      text-decoration: underline;
         <!-- font-style: italic; -->
   }

  #toc li a {
     display: inline-block;
  }
</style>

<div id="header">
   <div style="text-align:center"> <b> This isn’t the official RFC, please refer to the IETF website for the official RFC. Errors & omissions excepted </b> </div>
</div>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>RFC 3549</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_status_of_this_memo">Status of this Memo</a></li>
<li><a href="#_copyright_notice">Copyright Notice</a></li>
<li><a href="#_abstract">Abstract</a></li>
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_definitions">1.1. Definitions</a>
<ul class="sectlevel3">
<li><a href="#_control_plane_components_cpcs">1.1.1. Control Plane Components (CPCs)</a></li>
<li><a href="#_forwarding_engine_components_fecs">1.1.2. Forwarding Engine Components (FECs)</a>
<ul class="sectlevel4">
<li><a href="#_linux_ip_forwarding_engine_model">1.1.2.1. Linux IP Forwarding Engine Model</a></li>
</ul>
</li>
<li><a href="#_ip_services">1.1.3. IP Services</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_netlink_architecture">2. Netlink Architecture</a>
<ul class="sectlevel2">
<li><a href="#_netlink_logical_model">2.1. Netlink Logical Model</a></li>
<li><a href="#_message_format">2.2. Message Format</a></li>
<li><a href="#_protocol_model">2.3. Protocol Model</a>
<ul class="sectlevel3">
<li><a href="#_service_addressing">2.3.1. Service Addressing</a></li>
<li><a href="#_netlink_message_header">2.3.2. Netlink Message Header</a>
<ul class="sectlevel4">
<li><a href="#_mechanisms_for_creating_protocols">2.3.2.1. Mechanisms for Creating Protocols</a></li>
<li><a href="#_the_ack_netlink_message">2.3.2.2. The ACK Netlink Message</a></li>
</ul>
</li>
<li><a href="#_fe_system_services_templates">2.3.3. FE System Services' Templates</a>
<ul class="sectlevel4">
<li><a href="#_network_interface_service_module">2.3.3.1. Network Interface Service Module</a></li>
<li><a href="#_ip_address_service_module">2.3.3.2. IP Address Service Module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_currently_defined_netlink_ip_services">3. Currently Defined Netlink IP Services</a>
<ul class="sectlevel2">
<li><a href="#_ip_service_netlink_route">3.1. IP Service NETLINK_ROUTE</a>
<ul class="sectlevel3">
<li><a href="#_network_route_service_module">3.1.1. Network Route Service Module</a></li>
<li><a href="#_neighbor_setup_service_module">3.1.2. Neighbor Setup Service Module</a></li>
<li><a href="#_traffic_control_service">3.1.3. Traffic Control Service</a></li>
</ul>
</li>
<li><a href="#_ip_service_netlink_firewall">3.2. IP Service NETLINK_FIREWALL</a></li>
<li><a href="#_ip_service_netlink_arpd">3.3. IP Service NETLINK_ARPD</a></li>
</ul>
</li>
<li><a href="#_references">4. References</a>
<ul class="sectlevel2">
<li><a href="#_normative_references">4.1. Normative References</a></li>
<li><a href="#_informative_references">4.2. Informative References</a></li>
</ul>
</li>
<li><a href="#_security_considerations">5. Security Considerations</a></li>
<li><a href="#_acknowledgements">6. Acknowledgements</a></li>
<li><a href="#appendix_1">Appendix 1: Sample Service Hierarchy</a></li>
<li><a href="#appendix_2">Appendix 2: Sample Protocol for the Foo IP Service</a></li>
<li><a href="#appendix_2a">Appendix 2a: Interacting with Other IP services</a></li>
<li><a href="#appendix_3">Appendix 3: Examples</a></li>
<li><a href="#_authors_addresses">Authors' Addresses</a></li>
<li><a href="#_full_copyright_statement">Full Copyright Statement</a></li>
<li><a href="#_acknowledgement">Acknowledgement</a></li>
<li><a href="#_errata">Errata</a>
<ul class="sectlevel2">
<li><a href="#_reported">Reported</a>
<ul class="sectlevel3">
<li><a href="#_6014">6014</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<table class="tableblock frame-none grid-all stripes-none" style="width: 99%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network Working Group</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">J. Salim</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request for Comments: 3549</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">Znyx Networks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Category: Informational</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">H. Khosravi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">Intel</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">A. Kleen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">Suse</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">A. Kuznetsov</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">INR/Swsoft</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">July 2003</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-none grid-all" style="width: 99%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Linux Netlink as an IP Services Protocol</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_status_of_this_memo">Status of this Memo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This memo provides information for the Internet community.  It does
not specify an Internet standard of any kind.  Distribution of this
memo is unlimited.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_copyright_notice">Copyright Notice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copyright &#169; The Internet Society (2003).  All Rights Reserved.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_abstract">Abstract</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document describes Linux Netlink, which is used in Linux both as
an intra-kernel messaging system as well as between kernel and user
space.  The focus of this document is to describe Netlink&#8217;s
functionality as a protocol between a Forwarding Engine Component
(FEC) and a Control Plane Component (CPC), the two components that
define an IP service.  As a result of this focus, this document
ignores other uses of Netlink, including its use as a intra-kernel
messaging system, as an inter-process communication scheme (IPC), or
as a configuration tool for other non-networking or non-IP network
services (such as decnet, etc.).</p>
</div>
<div class="paragraph">
<p>This document is intended as informational in the context of prior
art for the ForCES IETF working group.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The concept of IP Service control-forwarding separation was first
introduced in the early 1990s by the BSD 4.4 routing sockets [9].
The focus at that time was a simple IP(v4) forwarding service and how
the CPC, either via a command line configuration tool or a dynamic
route daemon, could control forwarding tables for that IPv4
forwarding service.</p>
</div>
<div class="paragraph">
<p>The IP world has evolved considerably since those days.  Linux
Netlink, when observed from a service provisioning and management
point of view, takes routing sockets one step further by breaking the
barrier of focus around IPv4 forwarding.  Since the Linux 2.1 kernel,
Netlink has been providing the IP service abstraction to a few
services other than the classical RFC 1812 IPv4 forwarding.</p>
</div>
<div class="paragraph">
<p>The motivation for this document is not to list every possible
service for which Netlink is applied.  In fact, we leave out a lot of
services (multicast routing, tunneling, policy routing, etc). Neither
is this document intended to be a tutorial on Netlink.  The idea is
to explain the overall Netlink view with a special focus on the
mandatory building blocks within the ForCES charter (i.e., IPv4 and
QoS).  This document also serves to capture prior art to many
mechanisms that are useful within the context of ForCES.  The text is
limited to a subset of what is available in kernel 2.4.6, the newest
kernel when this document was first written.  It is also limited to
IPv4 functionality.</p>
</div>
<div class="paragraph">
<p>We first give some concept definitions and then describe how Netlink
fits in.</p>
</div>
<div class="sect2">
<h3 id="_definitions">1.1. Definitions</h3>
<div class="paragraph">
<p>A Control Plane (CP) is an execution environment that may have
several sub-components, which we refer to as CPCs.  Each CPC provides
control for a different IP service being executed by a Forwarding
Engine (FE) component.  This relationship means that there might be
several CPCs on a physical CP, if it is controlling several IP
services.  In essence, the cohesion between a CP component and an FE
component is the service abstraction.</p>
</div>
<div class="sect3">
<h4 id="_control_plane_components_cpcs">1.1.1. Control Plane Components (CPCs)</h4>
<div class="paragraph">
<p>Control Plane Components encompass signalling protocols, with
diversity ranging from dynamic routing protocols, such as OSPF [<a href="#ref_5">5</a>],
to tag distribution protocols, such as CR-LDP [<a href="#ref_7">7</a>]. Classical
management protocols and activities also fall under this category.
These include SNMP [<a href="#ref_6">6</a>], COPS [<a href="#ref_4">4</a>], and proprietary CLI/GUI
configuration mechanisms.  The purpose of the control plane is to
provide an execution environment for the above-mentioned activities
with the ultimate goal being to configure and manage the second
Network Element (NE) component: the FE.  The result of the
configuration defines the way that packets traversing the FE are
treated.</p>
</div>
</div>
<div class="sect3">
<h4 id="_forwarding_engine_components_fecs">1.1.2. Forwarding Engine Components (FECs)</h4>
<div class="paragraph">
<p>The FE is the entity of the NE that incoming packets (from the
network into the NE) first encounter.</p>
</div>
<div class="paragraph">
<p>The FE&#8217;s service-specific component massages the packet to provide it
with a treatment to achieve an IP service, as defined by the Control
Plane Components for that IP service.  Different services will
utilize different FECs.  Service modules may be chained to achieve a
more complex service (refer to the Linux FE model, described later).
When built for providing a specific service, the FE service component
will adhere to a forwarding model.</p>
</div>
<div class="sect4">
<h5 id="_linux_ip_forwarding_engine_model">1.1.2.1. Linux IP Forwarding Engine Model</h5>
<div class="literalblock">
<div class="content">
<pre>                        ____      +---------------+
                   +-&gt;-| FW |---&gt; | TCP, UDP, ... |
                   |   +----+     +---------------+
                   |                   |
                   ^                   v
                   |                  _|_
                   +----&lt;----+       | FW |
                             |       +----+
                             ^         |
                             |         Y
                           To host    From host
                            stack     stack
                             ^         |
                             |_____    |
Ingress                            ^   Y
device   ____    +-------+        +|---|--+   ____   +--------+ Egress
-&gt;-----&gt;| FW |--&gt;|Ingress|--&gt;----&gt;| Forw- |-&gt;| FW |-&gt;| Egress | device
        +----+   |  TC   |        |  ard  |  +----+  |   TC   |--&gt;
                 +-------+        +-------+          +--------+</pre>
</div>
</div>
<div class="paragraph">
<p>The figure above shows the Linux FE model per device.  The only
mandatory part of the datapath is the Forwarding module, which is RFC
1812 conformant.  The different Firewall (FW), Ingress Traffic
Control, and Egress Traffic Control building blocks are not mandatory
in the datapath and may even be used to bypass the RFC 1812 module.
These modules are shown as simple blocks in the datapath but, in
fact, could be multiple cascaded, independent submodules within the
indicated blocks.  More information can be found at [<a href="#ref_10">10</a>] and [<a href="#ref_11">11</a>].</p>
</div>
<div class="paragraph">
<p>Packets arriving at the ingress device first pass through a firewall
module.  Packets may be dropped, munged, etc., by the firewall
module.  The incoming packet, depending on set policy, may then be
passed via an Ingress Traffic Control module. Metering and policing
activities are contained within the Ingress TC module.  Packets may
be dropped, depending on metering results and policing policies, at
this module. Next, the packet is subjected to the only non-optional
module, the RFC 1812-conformant Forwarding module. The packet may be
dropped if it is nonconformant (to the many RFCs complementing 1812
and 1122).  This module is a juncture point at which packets destined
to the forwarding NE may be sent up to the host stack.</p>
</div>
<div class="paragraph">
<p>Packets that are not for the NE may further traverse a policy routing
submodule (within the forwarding module), if so provisioned.  Another
firewall module is walked next.  The firewall module can drop or
munge/transform packets, depending on the configured sub-modules
encountered and their policies.  If all goes well, the Egress TC
module is accessed next.</p>
</div>
<div class="paragraph">
<p>The Egress TC may drop packets for policing, scheduling, congestion
control, or rate control reasons.  Egress queues exist at this point
and any of the drops or delays may happen before or after the packet
is queued.  All is dependent on configured module algorithms and
policies.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ip_services">1.1.3. IP Services</h4>
<div class="paragraph">
<p>An IP service is the treatment of an IP packet within the NE.  This
treatment is provided by a combination of both the CPC and the FEC.</p>
</div>
<div class="paragraph">
<p>The time span of the service is from the moment when the packet
arrives at the NE to the moment that it departs.  In essence, an IP
service in this context is a Per-Hop Behavior.  CP components running
on NEs define the end-to-end path control for a service by running
control/signaling protocol/management-applications.  These
distributed CPCs unify the end-to-end view of the IP service.  As
noted above, these CP components then define the behavior of the FE
(and therefore the NE) for a described packet.</p>
</div>
<div class="paragraph">
<p>A simple example of an IP service is the classical IPv4 Forwarding.
In this case, control components, such as routing protocols (OSPF,
RIP, etc.) and proprietary CLI/GUI configurations, modify the FE&#8217;s
forwarding tables in order to offer the simple service of forwarding
packets to the next hop.  Traditionally, NEs offering this simple
service are known as routers.</p>
</div>
<div class="paragraph">
<p>In the diagram below, we show a simple FE&lt;&#8594;CP setup to provide an
example of the classical IPv4 service with an extension to do some
basic QoS egress scheduling and illustrate how the setup fits in this
described model.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>                        Control Plane (CP)
                       .------------------------------------
                       |    /^^^^^^\      /^^^^^^\         |
                       |   |        |    | COPS  |-\       |
                       |   | ospfd  |    |  PEP  |  \      |
                       |   \       /      \_____/    |     |
                     /------\_____/         |       /      |
                     | |        |           |     /        |
                     | |_________\__________|____|_________|
                     |           |          |    |
                    ******************************************
      Forwarding    ************* Netlink  layer ************
      Engine (FE)   *****************************************
       .-------------|-----------|----------|---|-------------
       |       IPv4 forwarding   |              |             |
       |       FE Service       /               /             |
       |       Component       /               /              |
       |       ---------------/---------------/---------      |
       |       |             |               /         |      |
packet |       |     --------|--        ----|-----     |   packet
in     |       |     |  IPv4    |      | Egress   |    |    out
--&gt;---&gt;|------&gt;|----&gt;|Forwarding|-----&gt;| QoS      |---&gt;| ----&gt;|-&gt;
       |       |     |          |      | Scheduler|    |      |
       |       |     -----------        ----------     |      |
       |       |                                       |      |
       |        ---------------------------------------       |
       |                                                      |
       -------------------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>The above diagram illustrates ospfd, an OSPF protocol control daemon,
and a COPS Policy Enforcement Point (PEP) as distinct CPCs.  The IPv4
FE component includes the IPv4 Forwarding service module as well as
the Egress Scheduling service module.  Another service might add a
policy forwarder between the IPv4 forwarder and the QoS egress
scheduler.  A simpler classical service would have constituted only
the IPv4 forwarder.</p>
</div>
<div class="paragraph">
<p>Over the years, it has become important to add additional services to
routers to meet emerging requirements.  More complex services
extending classical forwarding have been added and standardized.
These newer services might go beyond the layer 3 contents of the
packet header.  However, the name "router", although a misnomer, is
still used to describe these NEs.  Services (which may look beyond
the classical L3 service headers) include firewalling, QoS in
Diffserv and RSVP, NAT, policy based routing, etc.  Newer control
protocols or management activities are introduced with these new
services.</p>
</div>
<div class="paragraph">
<p>One extreme definition of a IP service is something for which a
service provider would be able to charge.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_netlink_architecture">2. Netlink Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Control of IP service components is defined by using templates.</p>
</div>
<div class="paragraph">
<p>The FEC and CPC participate to deliver the IP service by
communicating using these templates.  The FEC might continuously get
updates from the Control Plane Component on how to operate the
service (e.g., for v4 forwarding or for route additions or
deletions).</p>
</div>
<div class="paragraph">
<p>The interaction between the FEC and the CPC, in the Netlink context,
defines a protocol.  Netlink provides mechanisms for the CPC
(residing in user space) and the FEC (residing in kernel space) to
have their own protocol definition&#8201;&#8212;&#8201;kernel space and user space
just mean different protection domains.  Therefore, a wire protocol
is needed to communicate.  The wire protocol is normally provided by
some privileged service that is able to copy between multiple
protection domains.  We will refer to this service as the Netlink
service.  The Netlink service can also be encapsulated in a different
transport layer, if the CPC executes on a different node than the
FEC.  The FEC and CPC, using Netlink mechanisms, may choose to define
a reliable protocol between each other.  By default, however, Netlink
provides an unreliable communication.</p>
</div>
<div class="paragraph">
<p>Note that the FEC and CPC can both live in the same memory protection
domain and use the connect() system call to create a path to the peer
and talk to each other.  We will not discuss this mechanism further
other than to say that it is available. Throughout this document, we
will refer interchangeably to the FEC to mean kernel space and the
CPC to mean user space.  This denomination is not meant, however, to
restrict the two components to these protection domains or to the
same compute node.</p>
</div>
<div class="paragraph">
<p>Note: Netlink allows participation in IP services by both service
components.</p>
</div>
<div class="sect2">
<h3 id="_netlink_logical_model">2.1. Netlink Logical Model</h3>
<div class="paragraph">
<p>In the diagram below we show a simple FEC&lt;&#8594;CPC logical relationship.
We use the IPv4 forwarding FEC (NETLINK_ROUTE, which is discussed
further below) as an example.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>                 Control Plane (CP)
                .------------------------------------
                |    /^^^^^\        /^^^^^\          |
                |   |       |      / CPC-2 \         |
                |   | CPC-1 |     | COPS   |         |
                |   | ospfd |     |  PEP   |         |
                |   |      /       \____ _/          |
                |    \____/            |             |
                |      |               |             |
             ****************************************|
             ************* BROADCAST WIRE  ************
FE---------- *****************************************.
|      IPv4 forwarding |    |           |             |
|               FEC    |    |           |             |
|       --------------/ ----|-----------|--------     |
|       |            /      |           |       |     |
|       |     .-------.  .-------.   .------.   |     |
|       |     |Ingress|  | IPv4  |   |Egress|   |     |
|       |     |police |  |Forward|   | QoS  |   |     |
|       |     |_______|  |_______|   |Sched |   |     |
|       |                             ------    |     |
|        ---------------------------------------      |
|                                                     |
 -----------------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>Netlink logically models FECs and CPCs in the form of nodes
interconnected to each other via a broadcast wire.</p>
</div>
<div class="paragraph">
<p>The wire is specific to a service.  The example above shows the
broadcast wire belonging to the extended IPv4 forwarding service.</p>
</div>
<div class="paragraph">
<p>Nodes (CPCs or FECs as illustrated above) connect to the wire and
register to receive specific messages.  CPCs may connect to multiple
wires if it helps them to control the service better.  All nodes
(CPCs and FECs) dump packets on the broadcast wire.  Packets can be
discarded by the wire if they are malformed or not specifically
formatted for the wire.  Dropped packets are not seen by any of the
nodes.  The Netlink service may signal an error to the sender if it
detects a malformatted Netlink packet.</p>
</div>
<div class="paragraph">
<p>Packets sent on the wire can be broadcast, multicast, or unicast.
FECs or CPCs register for specific messages of interest for
processing or just monitoring purposes.</p>
</div>
<div class="paragraph">
<p>Appendices 1 and 2 have a high level overview of this interaction.</p>
</div>
</div>
<div class="sect2">
<h3 id="_message_format">2.2. Message Format</h3>
<div class="paragraph">
<p>There are three levels to a Netlink message: The general Netlink
message header, the IP service specific template, and the IP service
specific data.</p>
</div>
<div class="literalblock">
<div class="content">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                   Netlink message header                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                  IP Service Template                          |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                  IP Service specific data in TLVs             |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="paragraph">
<p>The Netlink message is used to communicate between the FEC and CPC
for parameterization of the FECs, asynchronous event notification of
FEC events to the CPCs, and statistics querying/gathering (typically
by a CPC).</p>
</div>
<div class="paragraph">
<p>The Netlink message header is generic for all services, whereas the
IP Service Template header is specific to a service.  Each IP Service
then carries parameterization data (CPC&#8594;FEC direction) or response
(FEC&#8594;CPC direction).  These parameterizations are in TLV (Type-
Length-Value) format and are unique to the service.</p>
</div>
<div class="paragraph">
<p>The different parts of the netlink message are discussed in the
following sections.</p>
</div>
</div>
<div class="sect2">
<h3 id="_protocol_model">2.3. Protocol Model</h3>
<div class="paragraph">
<p>This section expands on how Netlink provides the mechanism for
service-oriented FEC and CPC interaction.</p>
</div>
<div class="sect3">
<h4 id="_service_addressing">2.3.1. Service Addressing</h4>
<div class="paragraph">
<p>Access is provided by first connecting to the service on the FE.  The
connection is achieved by making a socket() system call to the
PF_NETLINK domain.  Each FEC is identified by a protocol number.  One
may open either SOCK_RAW or SOCK_DGRAM type sockets, although Netlink
does not distinguish between the two.  The socket connection provides
the basis for the FE&lt;&#8594;CP addressing.</p>
</div>
<div class="paragraph">
<p>Connecting to a service is followed (at any point during the life of
the connection) by either issuing a service-specific command (from
the CPC to the FEC, mostly for configuration purposes), issuing a
statistics-collection command, or subscribing/unsubscribing to
service events.  Closing the socket terminates the transaction.
Refer to Appendices 1 and 2 for examples.</p>
</div>
</div>
<div class="sect3">
<h4 id="_netlink_message_header">2.3.2. Netlink Message Header</h4>
<div class="paragraph">
<p>Netlink messages consist of a byte stream with one or multiple
Netlink headers and an associated payload.  If the payload is too big
to fit into a single message it, can be split over multiple Netlink
messages, collectively called a multipart message.  For multipart
messages, the first and all following headers have the NLM_F_MULTI
Netlink header flag set, except for the last header which has the
Netlink header type NLMSG_DONE.</p>
</div>
<div class="paragraph">
<p>The Netlink message header is shown below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Length                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type              |           Flags              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Sequence Number                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Process ID (PID)                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="paragraph">
<p>The fields in the header are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Length: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The length of the message in bytes, including the header.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Type: 16 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This field describes the message content.
It can be one of the standard message types:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NLMSG_NOOP  
</td>
<td class="hdlist2">
<p>Message is ignored.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLMSG_ERROR 
</td>
<td class="hdlist2">
<p>The message signals an error and the payload
contains a nlmsgerr structure.  This can be looked
at as a NACK and typically it is from FEC to CPC.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLMSG_DONE  
</td>
<td class="hdlist2">
<p>Message terminates a multipart message.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Individual IP services specify more message types, e.g.,
NETLINK_ROUTE service specifies several types, such as RTM_NEWLINK,
RTM_DELLINK, RTM_GETLINK, RTM_NEWADDR, RTM_DELADDR, RTM_NEWROUTE,
RTM_DELROUTE, etc.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Flags: 16 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The standard flag bits used in Netlink are</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NLM_F_REQUEST 
</td>
<td class="hdlist2">
<p>Must be set on all request messages (typically
from user space to kernel space)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLM_F_MULTI   
</td>
<td class="hdlist2">
<p>Indicates the message is part of a multipart
message terminated by NLMSG_DONE</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLM_F_ACK     
</td>
<td class="hdlist2">
<p>Request for an acknowledgment on success.
Typical direction of request is from user
space (CPC) to kernel space (FEC).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLM_F_ECHO    
</td>
<td class="hdlist2">
<p>Echo this request.  Typical direction of
request is from user space (CPC) to kernel
space (FEC).</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additional flag bits for GET requests on config information in
the FEC.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NLM_F_ROOT   
</td>
<td class="hdlist2">
<p>Return the complete table instead of a
single entry.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLM_F_MATCH  
</td>
<td class="hdlist2">
<p>Return all entries matching criteria passed in
message content.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLM_F_ATOMIC 
</td>
<td class="hdlist2">
<p>Return an atomic snapshot of the table being
referenced.  This may require special
privileges because it has the potential to
interrupt service in the FE for a longer time.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Convenience macros for flag bits:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NLM_F_DUMP   
</td>
<td class="hdlist2">
<p>This is NLM_F_ROOT or&#8217;ed with NLM_F_MATCH</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additional flag bits for NEW requests</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NLM_F_REPLACE 
</td>
<td class="hdlist2">
<p>Replace existing matching config object with
this request.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLM_F_EXCL    
</td>
<td class="hdlist2">
<p>Don&#8217;t replace the config object if it already
exists.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLM_F_CREATE  
</td>
<td class="hdlist2">
<p>Create config object if it doesn&#8217;t already
exist.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NLM_F_APPEND  
</td>
<td class="hdlist2">
<p>Add to the end of the object list.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For those familiar with BSDish use of such operations in route
sockets, the equivalent translations are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>BSD ADD operation equates to NLM_F_CREATE or-ed with NLM_F_EXCL</p>
</li>
<li>
<p>BSD CHANGE operation equates to NLM_F_REPLACE</p>
</li>
<li>
<p>BSD Check operation equates to NLM_F_EXCL</p>
</li>
<li>
<p>BSD APPEND equivalent is actually mapped to NLM_F_CREATE</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Sequence Number: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The sequence number of the message.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Process ID (PID): 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The PID of the process sending the message.  The PID is used by the
kernel to multiplex to the correct sockets.  A PID of zero is used
when sending messages to user space from the kernel.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_mechanisms_for_creating_protocols">2.3.2.1. Mechanisms for Creating Protocols</h5>
<div class="paragraph">
<p>One could create a reliable protocol between an FEC and a CPC by
using the combination of sequence numbers, ACKs, and retransmit
timers.  Both sequence numbers and ACKs are provided by Netlink;
timers are provided by Linux.</p>
</div>
<div class="paragraph">
<p>One could create a heartbeat protocol between the FEC and CPC by
using the ECHO flags and the NLMSG_NOOP message.</p>
</div>
</div>
<div class="sect4">
<h5 id="_the_ack_netlink_message">2.3.2.2. The ACK Netlink Message</h5>
<div class="paragraph">
<p>This message is actually used to denote both an ACK and a NACK.
Typically, the direction is from FEC to CPC (in response to an ACK
request message).  However, the CPC should be able to send ACKs back
to FEC when requested.  The semantics for this are IP service
specific.</p>
</div>
<div class="literalblock">
<div class="content">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Netlink message header                  |
|                       type = NLMSG_ERROR                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Error code                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       OLD Netlink message header              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="paragraph">
<p>Error code: integer (typically 32 bits)</p>
</div>
<div class="paragraph">
<p>An error code of zero indicates that the message is an ACK response.
An ACK response message contains the original Netlink message header,
which can be used to compare against (sent sequence numbers, etc).</p>
</div>
<div class="paragraph">
<p>A non-zero error code message is equivalent to a Negative ACK (NACK).
In such a situation, the Netlink data that was sent down to the
kernel is returned appended to the original Netlink message header.
An error code printable via the perror() is also set (not in the
message header, rather in the executing environment state variable).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fe_system_services_templates">2.3.3. FE System Services' Templates</h4>
<div class="paragraph">
<p>These are services that are offered by the system for general use by
other services.  They include the ability to configure, gather
statistics and listen to changes in shared resources.  IP address
management, link events, etc. fit here.  We create this section for
these services for logical separation, despite the fact that they are
accessed via the NETLINK_ROUTE FEC.  The reason that they exist
within NETLINK_ROUTE is due to historical cruft: the BSD 4.4 Route
Sockets implemented them as part of the IPv4 forwarding sockets.</p>
</div>
<div class="sect4">
<h5 id="_network_interface_service_module">2.3.3.1. Network Interface Service Module</h5>
<div class="paragraph">
<p>This service provides the ability to create, remove, or get
information about a specific network interface.  The network
interface can be either physical or virtual and is network protocol
independent (e.g., an x.25 interface can be defined via this
message).  The Interface service message template is shown below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Family    |   Reserved  |          Device Type              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Interface Index                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Device Flags                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Change Mask                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Family: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This is always set to AF_UNSPEC.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Device Type: 16 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This defines the type of the link.  The link could be Ethernet, a
tunnel, etc.  We are interested only in IPv4, although the link type
is L3 protocol-independent.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Interface Index: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Uniquely identifies interface.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Device Flags: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
IFF_UP          
</td>
<td class="hdlist2">
<p>Interface is administratively up.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_BROADCAST   
</td>
<td class="hdlist2">
<p>Valid broadcast address set.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_DEBUG       
</td>
<td class="hdlist2">
<p>Internal debugging flag.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_LOOPBACK    
</td>
<td class="hdlist2">
<p>Interface is a loopback interface.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_POINTOPOINT 
</td>
<td class="hdlist2">
<p>Interface is a point-to-point link.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_RUNNING     
</td>
<td class="hdlist2">
<p>Interface is operationally up.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_NOARP       
</td>
<td class="hdlist2">
<p>No ARP protocol needed for this interface.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_PROMISC     
</td>
<td class="hdlist2">
<p>Interface is in promiscuous mode.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_NOTRAILERS  
</td>
<td class="hdlist2">
<p>Avoid use of trailers.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_ALLMULTI    
</td>
<td class="hdlist2">
<p>Receive all multicast packets.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_MASTER      
</td>
<td class="hdlist2">
<p>Master of a load balancing bundle.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_SLAVE       
</td>
<td class="hdlist2">
<p>Slave of a load balancing bundle.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_MULTICAST   
</td>
<td class="hdlist2">
<p>Supports multicast.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_PORTSEL     
</td>
<td class="hdlist2">
<p>Is able to select media type via ifmap.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_AUTOMEDIA   
</td>
<td class="hdlist2">
<p>Auto media selection active.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFF_DYNAMIC     
</td>
<td class="hdlist2">
<p>Interface was dynamically created.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Change Mask: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Reserved for future use.  Must be set to 0xFFFFFFFF.</p>
</div>
<div class="paragraph">
<p>Applicable attributes:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Attribute</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFLA_UNSPEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unspecified.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFLA_ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hardware address interface L2 address.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFLA_BROADCAST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hardware address L2 broadcast address.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFLA_IFNAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII string device name.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFLA_MTU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MTU of the device.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFLA_LINK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ifindex of link to which this device is bound.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFLA_QDISC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII string defining egress root queuing discipline.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFLA_STATS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface statistics.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Netlink message types specific to this service:
RTM_NEWLINK, RTM_DELLINK, and RTM_GETLINK</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_ip_address_service_module">2.3.3.2. IP Address Service Module</h5>
<div class="paragraph">
<p>This service provides the ability to add, remove, or receive
information about an IP address associated with an interface.  The
address provisioning service message template is shown below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Family    |     Length    |     Flags     |    Scope      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Interface Index                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Family: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Address Family: AF_INET for IPv4; and AF_INET6 for IPV6.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Length: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The length of the address mask.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Flags: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
IFA_F_SECONDARY  
</td>
<td class="hdlist2">
<p>For secondary address (alias interface).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFA_F_PERMANENT  
</td>
<td class="hdlist2">
<p>For a permanent address set by the user.
When this is not set, it means the address
was dynamically created (e.g., by stateless
autoconfiguration).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFA_F_DEPRECATED 
</td>
<td class="hdlist2">
<p>Defines deprecated (IPV4) address.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IFA_F_TENTATIVE  
</td>
<td class="hdlist2">
<p>Defines tentative (IPV4) address (duplicate
address detection is still in progress).</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Scope: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The address scope in which the address stays valid.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
SCOPE_UNIVERSE:         
</td>
<td class="hdlist2">
<p>Global scope.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
SCOPE_SITE (IPv6 only): 
</td>
<td class="hdlist2">
<p>Only valid within this site.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
SCOPE_LINK:             
</td>
<td class="hdlist2">
<p>Valid only on this device.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
SCOPE_HOST:             
</td>
<td class="hdlist2">
<p>Valid only on this host.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div id="errata_6014" class="dlist">
<dl>
<dt class="hdlist1"><span class="rfc-error-text">le attributes:</span> </dt>
<dd>
<div class="exampleblock">
<div class="content">
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Attribute</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFA_UNSPEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unspecified.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFA_ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raw protocol address of interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFA_LOCAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raw protocol local address.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFA_LABEL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII string name of the interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFA_BROADCAST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raw protocol broadcast address.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFA_ANYCAST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raw protocol anycast address.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">IFA_CACHEINFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache address information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Netlink messages specific to this service: RTM_NEWADDR,
RTM_DELADDR, and RTM_GETADDR.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_currently_defined_netlink_ip_services">3. Currently Defined Netlink IP Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although there are many other IP services defined that are using
Netlink, as mentioned earlier, we will talk only about a handful of
those integrated into kernel version 2.4.6.  These are:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>NETLINK_ROUTE, NETLINK_FIREWALL, and NETLINK_ARPD.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ip_service_netlink_route">3.1. IP Service NETLINK_ROUTE</h3>
<div class="paragraph">
<p>This service allows CPCs to modify the IPv4 routing table in the
Forwarding Engine.  It can also be used by CPCs to receive routing
updates, as well as to collect statistics.</p>
</div>
<div class="sect3">
<h4 id="_network_route_service_module">3.1.1. Network Route Service Module</h4>
<div class="paragraph">
<p>This service provides the ability to create, remove or receive
information about a network route.  The service message template is
shown below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Family    |  Src length   |  Dest length  |     TOS       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Table ID   |   Protocol    |     Scope     |     Type      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Flags                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Family: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Address Family: AF_INET for IPv4; and AF_INET6 for IPV6.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Src length: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Prefix length of source IP address.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Dest length: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Prefix length of destination IP address.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">TOS: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The 8-bit TOS (should be deprecated to make room for DSCP).</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Table ID: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Table identifier.  Up to 255 route tables are supported.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
RT_TABLE_UNSPEC  
</td>
<td class="hdlist2">
<p>An unspecified routing table.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RT_TABLE_DEFAULT 
</td>
<td class="hdlist2">
<p>The default table.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RT_TABLE_MAIN    
</td>
<td class="hdlist2">
<p>The main table.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RT_TABLE_LOCAL   
</td>
<td class="hdlist2">
<p>The local table.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The user may assign arbitrary values between
RT_TABLE_UNSPEC(0) and RT_TABLE_DEFAULT(253).</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Protocol: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Identifies what/who added the route.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Protocol</th>
<th class="tableblock halign-center valign-top">Route origin.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTPROT_UNSPEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unknown.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTPROT_REDIRECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By an ICMP redirect.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTPROT_KERNEL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By the kernel.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTPROT_BOOT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">During bootup.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTPROT_STATIC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By the administrator.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Values larger than RTPROT_STATIC(4) are not interpreted by the
kernel, they are just for user information.  They may be used to
tag the source of a routing information or to distinguish between
multiple routing daemons.  See &lt;linux/rtnetlink.h&gt; for the
routing daemon identifiers that are already assigned.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Scope: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Route scope (valid distance to destination).</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
RT_SCOPE_UNIVERSE 
</td>
<td class="hdlist2">
<p>Global route.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RT_SCOPE_SITE     
</td>
<td class="hdlist2">
<p>Interior route in the local autonomous system.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RT_SCOPE_LINK     
</td>
<td class="hdlist2">
<p>Route on this link.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RT_SCOPE_HOST     
</td>
<td class="hdlist2">
<p>Route on the local host.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RT_SCOPE_NOWHERE  
</td>
<td class="hdlist2">
<p>Destination does not exist.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The values between RT_SCOPE_UNIVERSE(0) and RT_SCOPE_SITE(200)
are available to the user.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Type: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The type of route.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Route type</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_UNSPEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unknown route.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_UNICAST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A gateway or direct route.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_LOCAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A local interface route.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_BROADCAST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A local broadcast route
                   (sent as a broadcast).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_ANYCAST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An anycast route.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_MULTICAST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A multicast route.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_BLACKHOLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A silent packet dropping route.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_UNREACHABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An unreachable destination.
                    Packets dropped and host
                    unreachable ICMPs are sent to the
                    originator.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_PROHIBIT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A packet rejection route.  Packets
                   are dropped and communication
                   prohibited ICMPs are sent to the
                   originator.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_THROW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When used with policy routing,
                   continue routing lookup in another
                   table.  Under normal routing,
                   packets are dropped and net
                   unreachable ICMPs are sent to the
                   originator.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_NAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A network address translation
                   rule.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTN_XRESOLVE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refer to an external resolver (not
                   implemented).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
<dt class="hdlist1">Flags: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Further qualify the route.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
RTM_F_NOTIFY   
</td>
<td class="hdlist2">
<p>If the route changes, notify the user.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RTM_F_CLONED   
</td>
<td class="hdlist2">
<p>Route is cloned from another route.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
RTM_F_EQUALIZE 
</td>
<td class="hdlist2">
<p>Allow randomization of next hop
path in multi-path routing
(currently not implemented).</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Attributes applicable to this service:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Attribute</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_UNSPEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_DST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protocol address for route
                 destination address.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_SRC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protocol address for route source
                 address.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_IIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input interface index.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_OIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output interface index.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_GATEWAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protocol address for the gateway of
                the route</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_PRIORITY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Priority of route.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_PREFSRC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Preferred source address in cases
                where more than one source address
                could be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_METRICS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Route metrics attributed to route
                and associated protocols (e.g.,
                RTT, initial TCP window, etc.).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_MULTIPATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multipath route next hop&#8217;s
                attributes.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_PROTOINFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Firewall based policy routing
                attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_FLOW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Route realm.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTA_CACHEINFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cached route information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Additional Netlink message types applicable to this service:
RTM_NEWROUTE, RTM_DELROUTE, and RTM_GETROUTE</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_neighbor_setup_service_module">3.1.2. Neighbor Setup Service Module</h4>
<div class="paragraph">
<p>This service provides the ability to add, remove, or receive
information about a neighbor table entry (e.g., an ARP entry or an
IPv4 neighbor solicitation, etc.).  The service message template is
shown below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Family    |    Reserved1  |           Reserved2           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Interface Index                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           State             |     Flags     |     Type      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Family: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Address Family: AF_INET for IPv4; and AF_INET6 for IPV6.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Interface Index: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The unique interface index.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">State: 16 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>A bitmask of the following states:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NUD_INCOMPLETE 
</td>
<td class="hdlist2">
<p>Still attempting to resolve.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NUD_REACHABLE  
</td>
<td class="hdlist2">
<p>A confirmed working cache entry</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NUD_STALE      
</td>
<td class="hdlist2">
<p>an expired cache entry.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NUD_DELAY      
</td>
<td class="hdlist2">
<p>Neighbor no longer reachable.
Traffic sent, waiting for
confirmation.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NUD_PROBE      
</td>
<td class="hdlist2">
<p>A cache entry that is currently
being re-solicited.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NUD_FAILED     
</td>
<td class="hdlist2">
<p>An invalid cache entry.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NUD_NOARP      
</td>
<td class="hdlist2">
<p>A device which does not do neighbor
discovery (ARP).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NUD_PERMANENT  
</td>
<td class="hdlist2">
<p>A static entry.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Flags: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NTF_PROXY  
</td>
<td class="hdlist2">
<p>A proxy ARP entry.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NTF_ROUTER 
</td>
<td class="hdlist2">
<p>An IPv6 router.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Attributes applicable to this service:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Attributes</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">NDA_UNSPEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unknown type.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">NDA_DST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A neighbour cache network.
                  layer destination address</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">NDA_LLADDR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A neighbor cache link layer
                  address.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">NDA_CACHEINFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache statistics.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Additional Netlink message types applicable to this service:
RTM_NEWNEIGH, RTM_DELNEIGH, and RTM_GETNEIGH.</p>
</div>
</div>
<div class="sect3">
<h4 id="_traffic_control_service">3.1.3. Traffic Control Service</h4>
<div class="paragraph">
<p>This service provides the ability to provision, query or listen to
events under the auspices of traffic control.  These include queuing
disciplines, (schedulers and queue treatment algorithms&#8201;&#8212;&#8201;e.g.,
priority-based scheduler or the RED algorithm) and classifiers.
Linux Traffic Control Service is very flexible and allows for
hierarchical cascading of the different blocks for traffic resource
sharing.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>       ++    ++                 +-----+   +-------+   ++     ++ .++
       || .  ||     +------+    |     |--&gt;| Qdisc |--&gt;||     ||  ||
       ||    ||----&gt;|Filter|---&gt;|Class|   +-------+   ||-+   ||  ||
       ||    ||  |  +------+    |     +---------------+| |   ||  ||
       || .  ||  |              +----------------------+ |   || .||
       || .  ||  |  +------+                             |   ||  ||
       ||    ||  +-&gt;|Filter|-_  +-----+   +-------+   ++ |   || .||
       || --&gt;||  |  +------+  -&gt;|     |--&gt;| Qdisc |--&gt;|| |   ||-&gt;||
       || .  ||  |              |Class|   +-------+   ||-+--&gt;|| .||
-&gt;dev-&gt;||    ||  |  +------+ _-&gt;|     +---------------+|     ||  ||
       ||    ||  +-&gt;|Filter|-   +----------------------+     || .||
       ||    ||     +------+                                 || .||
       || .  |+----------------------------------------------+|  ||
       ||    |          Parent Queuing discipline             | .||
       || .  +------------------------------------------------+ .||
       || . . .. . . .. . .                 . .. .. .. .      .. ||
       |+--------------------------------------------------------+|
       |                 Parent Queuing discipline                |
       |                  (attached to egress device)             |
       +----------------------------------------------------------+</pre>
</div>
</div>
<div class="paragraph">
<p>The above diagram shows an example of the Egress TC block.  We try to
be very brief here.  For more information, please refer to [<a href="#ref_11">11</a>].  A
packet first goes through a filter that is used to identify a class
to which the packet may belong.  A class is essentially a terminal
queuing discipline and has a queue associated with it.  The queue may
be subject to a simple algorithm, like FIFO, or a more complex one,
like RED or a token bucket.  The outermost queuing discipline, which
is referred to as the parent is typically associated with a
scheduler.  Within this scheduler hierarchy, however, may be other
scheduling algorithms, making the Linux Egress TC very flexible.</p>
</div>
<div class="paragraph">
<p>The service message template that makes this possible is shown below.
This template is used in both the ingress and the egress queuing
disciplines (refer to the egress traffic control model in the FE
model section).  Each of the specific components of the model has
unique attributes that describe it best.  The common attributes are
described below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Family    |  Reserved1    |         Reserved2             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Interface Index                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Qdisc handle                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Parent Qdisc                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        TCM Info                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Family: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Address Family: AF_INET for IPv4; and AF_INET6 for IPV6.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Interface Index: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The unique interface index.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Qdisc handle: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Unique identifier for instance of queuing discipline.  Typically,
this is split into major:minor of 16 bits each.  The major number
would also be the major number of the parent of this instance.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Parent Qdisc: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Used in hierarchical layering of queuing disciplines.  If this value
and the Qdisc handle are the same and equal to TC_H_ROOT, then the
defined qdisc is the top most layer known as the root qdisc.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">TCM Info: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Set by the FE to 1 typically, except when the Qdisc instance is in
use, in which case it is set to imply a reference count.  From the
CPC towards the direction of the FEC, this is typically set to 0
except when used in the context of filters.  In that case, this 32-
bit field is split into a 16-bit priority field and 16-bit protocol
field.  The protocol is defined in kernel source
&lt;include/linux/if_ether.h&gt;, however, the most commonly used one is
ETH_P_IP (the IP protocol).</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The priority is used for conflict resolution when filters intersect
in their expressions.</p>
</div>
<div class="paragraph">
<p>Generic attributes applicable to this service:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Attribute</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCA_KIND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Canonical name of FE component.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCA_STATS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generic usage statistics of FEC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCA_RATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rate estimator being attached to
                FEC.  Takes snapshots of stats to
                compute rate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCA_XSTATS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specific statistics of FEC.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCA_OPTIONS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nested FEC-specific attributes.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#appendix_3">Appendix 3</a> has an example of configuring an FE component for a FIFO
Qdisc.</p>
</div>
<div class="paragraph">
<p>Additional Netlink message types applicable to this service:
RTM_NEWQDISC, RTM_DELQDISC, RTM_GETQDISC, RTM_NEWTCLASS,
RTM_DELTCLASS, RTM_GETTCLASS, RTM_NEWTFILTER, RTM_DELTFILTER, and
RTM_GETTFILTER.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ip_service_netlink_firewall">3.2. IP Service NETLINK_FIREWALL</h3>
<div class="paragraph">
<p>This service allows CPCs to receive, manipulate, and re-inject
packets via the IPv4 firewall service modules in the FE.  A firewall
rule is first inserted to activate packet redirection.  The CPC
informs the FEC whether it would like to receive just the metadata on
the packet or the actual data and, if the metadata is desired, what
is the maximum data length to be redirected.  The redirected packets
are still stored in the FEC, waiting a verdict from the CPC.  The
verdict could constitute a simple accept or drop decision of the
packet, in which case the verdict is imposed on the packet still
sitting on the FEC.  The verdict may also include a modified packet
to be sent on as a replacement.</p>
</div>
<div class="paragraph">
<p>Two types of messages exist that can be sent from CPC to FEC.  These
are: Mode messages and Verdict messages.  Mode messages are sent
immediately to the FEC to describe what the CPC would like to
receive.  Verdict messages are sent to the FEC after a decision has
been made on the fate of a received packet.  The formats are
described below.</p>
</div>
<div class="paragraph">
<p>The mode message is described first.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Mode    |    Reserved1  |           Reserved2             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Range                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Mode: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Control information on the packet to be sent to the CPC.  The
different types are:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
IPQ_COPY_META   
</td>
<td class="hdlist2">
<p>Copy only packet metadata to CPC.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
IPQ_COPY_PACKET 
</td>
<td class="hdlist2">
<p>Copy packet metadata and packet payloads to CPC.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Range: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>If IPQ_COPY_PACKET, this defines the maximum length to copy.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A packet and associated metadata received from user space looks
as follows.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Packet ID                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Mark                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       timestamp_m                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       timestamp_u                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          hook                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       indev_name                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       outdev_name                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           hw_protocol       |        hw_type                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         hw_addrlen          |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       hw_addr                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       data_len                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Payload . . .                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Packet ID: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The unique packet identifier as passed to the CPC by the FEC.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Mark: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The internal metadata value set to describe the rule in which
the packet was picked.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">timestamp_m: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Packet arrival time (seconds)</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">timestamp_u: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Packet arrival time (useconds in addition to the seconds in
timestamp_m)</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">hook: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The firewall module from which the packet was picked.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">indev_name: 128 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>ASCII name of incoming interface.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">outdev_name: 128 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>ASCII name of outgoing interface.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">hw_protocol: 16 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Hardware protocol, in network order.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">hw_type: 16 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Hardware type.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">hw_addrlen: 8 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Hardware address length.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">hw_addr: 64 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Hardware address.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">data_len: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Length of packet data.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Payload: size defined by data_len </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The payload of the packet received.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The Verdict message format is as follows</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Value                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Packet ID                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Data Length                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Payload . . .                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Value: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This is the verdict to be imposed on the packet still sitting
in the FEC.  Verdicts could be:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NF_ACCEPT 
</td>
<td class="hdlist2">
<p>Accept the packet and let it continue its
traversal.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NF_DROP   
</td>
<td class="hdlist2">
<p>Drop the packet.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Packet ID: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The packet identifier as passed to the CPC by the FEC.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Data Length: 32 bits </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The data length of the modified packet (in bytes).  If you don&#8217;t
modify the packet just set it to 0.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Payload: </dt>
<dd>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Size as defined by the Data Length field.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_ip_service_netlink_arpd">3.3. IP Service NETLINK_ARPD</h3>
<div class="paragraph">
<p>This service is used by CPCs for managing the neighbor table in the
FE.  The message format used between the FEC and CPC is described in
the section on the Neighbor Setup Service Module.</p>
</div>
<div class="paragraph">
<p>The CPC service is expected to participate in neighbor solicitation
protocol(s).</p>
</div>
<div class="paragraph">
<p>A neighbor message of type RTM_NEWNEIGH is sent towards the CPC by
the FE to inform the CPC of changes that might have happened on that
neighbor&#8217;s entry (e.g., a neighbor being perceived as unreachable).</p>
</div>
<div class="paragraph">
<p>RTM_GETNEIGH is used to solicit the CPC for information on a specific
neighbor.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">4. References</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_references">4.1. Normative References</h3>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a id="ref_1"></a> [1] 
</td>
<td class="hdlist2">
<p>Braden, R., Clark, D. and S. Shenker, "Integrated Services in
the Internet Architecture: an Overview", RFC 1633, June 1994.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_2"></a> [2] 
</td>
<td class="hdlist2">
<p>Baker, F., "Requirements for IP Version 4 Routers", RFC 1812,
June 1995.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_3"></a> [3] 
</td>
<td class="hdlist2">
<p>Blake, S., Black, D., Carlson, M., Davies, E, Wang, Z. and W.
Weiss, "An Architecture for Differentiated Services", RFC 2475,
December 1998.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_4"></a> [4] 
</td>
<td class="hdlist2">
<p>Durham, D., Boyle, J., Cohen, R., Herzog, S., Rajan, R. and A.
Sastry, "The COPS (Common Open Policy Service) Protocol", RFC
2748, January 2000.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_5"></a> [5] 
</td>
<td class="hdlist2">
<p>Moy, J., "OSPF Version 2", STD 54, RFC 2328, April 1998.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_6"></a> [6] 
</td>
<td class="hdlist2">
<p>Case, J., Fedor, M., Schoffstall, M. and C. Davin, "Simple
Network Management Protocol (SNMP)", STD 15, RFC 1157, May 1990.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_7"></a> [7] 
</td>
<td class="hdlist2">
<p>Andersson, L., Doolan, P., Feldman, N., Fredette, A. and B.
Thomas, "LDP Specification", RFC 3036, January 2001.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_8"></a> [8] 
</td>
<td class="hdlist2">
<p>Bernet, Y., Blake, S., Grossman, D. and A. Smith, "An Informal
Management Model for DiffServ Routers", RFC 3290, May 2002.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_informative_references">4.2. Informative References</h3>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a id="ref_9"></a>    [9] 
</td>
<td class="hdlist2">
<p>G. R. Wright, W. Richard Stevens.  "TCP/IP Illustrated Volume 2,
Chapter 20", June 1995.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_10"></a> [10] 
</td>
<td class="hdlist2">
<p><a href="http://www.netfilter.org" class="bare">http://www.netfilter.org</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="ref_11"></a> [11] 
</td>
<td class="hdlist2">
<p><a href="http://diffserv.sourceforge.net" class="bare">http://diffserv.sourceforge.net</a></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security_considerations">5. Security Considerations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Netlink lives in a trusted environment of a single host separated by
kernel and user space.  Linux capabilities ensure that only someone
with CAP_NET_ADMIN capability (typically, the root user) is allowed
to open sockets.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements">6. Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>1) Andi Kleen, for man pages on netlink and rtnetlink.</p>
</div>
<div class="paragraph">
<p>2) Alexey Kuznetsov is credited for extending Netlink to the IP
   service delivery model.  The original Netlink character device was
   written by Alan Cox.</p>
</div>
<div class="paragraph">
<p>3) Jeremy Ethridge for taking the role of someone who did not
   understand Netlink and reviewing the document to make sure that it
   made sense.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix_1">Appendix 1: Sample Service Hierarchy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the diagram below we show a simple IP service, foo, and the
interaction it has between CP and FE components for the service
(labels 1-3).</p>
</div>
<div class="paragraph">
<p>The diagram is also used to demonstrate CP&lt;&#8594;FE addressing.  In this
section, we illustrate only the addressing semantics.  In <a href="#appendix_2">Appendix 2</a>,
the diagram is referenced again to define the protocol interaction
between service foo&#8217;s CPC and FEC (labels 4-10).</p>
</div>
<div class="literalblock">
<div class="content">
<pre> CP
[--------------------------------------------------------.
|   .-----.                                              |
|  |                         . -------.                  |
|  |  CLI   |               /           \                |
|  |        |              | CP protocol |               |
|         /-&gt;&gt; -.          |  component  | &lt;-.           |
|    __ _/      |          |   For       |   |           |
|                |         | IP service  |   ^           |
|                Y         |    foo      |   |           |
|                |           ___________/    ^           |
|                Y   1,4,6,8,9 /  ^ 2,5,10   | 3,7       |
 --------------- Y------------/---|----------|-----------
                 |           ^    |          ^
               **|***********|****|**********|**********
               ************* Netlink  layer ************
               **|***********|****|**********|**********
       FE        |           |    ^          ^
       .-------- Y-----------Y----|--------- |----.
       |                    |              /      |
       |                    Y            /        |
       |          . --------^-------.  /          |
       |          |FE component/module|/          |
       |          |  for IP Service   |           |
---&gt;---|------&gt;---|     foo           |-----&gt;-----|------&gt;--
       |           -------------------            |
       |                                          |
       |                                          |
        ------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>The control plane protocol for IP service foo does the following to
connect to its FE counterpart.  The steps below are also numbered
above in the diagram.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Connect to the IP service foo through a socket connect.  A typical
connection would be via a call to: socket(AF_NETLINK, SOCK_RAW,
NETLINK_FOO).</p>
</li>
<li>
<p>Bind to listen to specific asynchronous events for service foo.</p>
</li>
<li>
<p>Bind to listen to specific asynchronous FE events.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix_2">Appendix 2: Sample Protocol for the Foo IP Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our example IP service foo is used again to demonstrate how one can
deploy a simple IP service control using Netlink.</p>
</div>
<div class="paragraph">
<p>These steps are continued from <a href="#appendix_1">Appendix 1</a> (hence the numbering).</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Query for current config of FE component.</p>
</li>
<li>
<p>Receive response to (4) via channel on (3).</p>
</li>
<li>
<p>Query for current state of IP service foo.</p>
</li>
<li>
<p>Receive response to (6) via channel on (2).</p>
</li>
<li>
<p>Register the protocol-specific packets you would like the FE to
forward to you.</p>
</li>
<li>
<p>Send service-specific foo commands and receive responses for them,
if needed.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix_2a">Appendix 2a: Interacting with Other IP services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The diagram in <a href="#appendix_1">Appendix 1</a> shows another control component configuring
the same service.  In this case, it is a proprietary Command Line
Interface.  The CLI may or may not be using the Netlink protocol to
communicate to the foo component.  If the CLI issues commands that
will affect the policy of the FEC for service foo then, then the foo
CPC is notified.  It could then make algorithmic decisions based on
this input.  For example, if an FE allowed another service to delete
policies installed by a different service and a policy that foo
installed was deleted by service bar, there might be a need to
propagate this to all the peers of service foo.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix_3">Appendix 3: Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this example, we show a simple configuration Netlink message sent
from a TC CPC to an egress TC FIFO queue.  This queue algorithm is
based on packet counting and drops packets when the limit exceeds 100
packets.  We assume that the queue is in a hierarchical setup with a
parent 100:0 and a classid of 100:1 and that it is to be installed on
a device with an ifindex of 4.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Length (52)                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Type (RTM_NEWQDISC)           | Flags (NLM_F_EXCL |         |
|                               |NLM_F_CREATE | NLM_F_REQUEST)|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Sequence Number(arbitrary number)      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Process ID (0)                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Family(AF_INET)|  Reserved1    |         Reserved1           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Interface Index  (4)                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Qdisc handle  (0x1000001)              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Parent Qdisc   (0x1000000)              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        TCM Info  (0)                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type (TCA_KIND)   |           Length(4)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Value ("pfifo")                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type (TCA_OPTIONS) |          Length(4)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Value (limit=100)                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authors_addresses">Authors' Addresses</h2>
<div class="sectionbody">
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Jamal Hadi Salim<br>
Znyx Networks<br>
Ottawa, Ontario<br>
Canada</p>
</div>
<div class="paragraph">
<p>EMail: <a href="mailto:hadi@znyx.com">hadi@znyx.com</a></p>
</div>
<div class="paragraph">
<p>Hormuzd M Khosravi<br>
Intel<br>
2111 N.E. 25th Avenue JF3-206<br>
Hillsboro OR 97124-5961<br>
USA</p>
</div>
<div class="paragraph">
<p>Phone: +1 503 264 0334<br>
EMail: <a href="mailto:hormuzd.m.khosravi@intel.com">hormuzd.m.khosravi@intel.com</a></p>
</div>
<div class="paragraph">
<p>Andi Kleen<br>
SuSE<br>
Stahlgruberring 28<br>
81829 Muenchen<br>
Germany</p>
</div>
<div class="paragraph">
<p>EMail: <a href="mailto:ak@suse.de">ak@suse.de</a></p>
</div>
<div class="paragraph">
<p>Alexey Kuznetsov<br>
INR/Swsoft<br>
Moscow<br>
Russia</p>
</div>
<div class="paragraph">
<p>EMail: <a href="mailto:kuznet@ms2.inr.ac.ru">kuznet@ms2.inr.ac.ru</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_full_copyright_statement">Full Copyright Statement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copyright &#169; The Internet Society (2003).  All Rights Reserved.</p>
</div>
<div class="paragraph">
<p>This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it
or assist in its implementation may be prepared, copied, published
and distributed, in whole or in part, without restriction of any
kind, provided that the above copyright notice and this paragraph are
included on all such copies and derivative works.  However, this
document itself may not be modified in any way, such as by removing
the copyright notice or references to the Internet Society or other
Internet organizations, except as needed for the purpose of
developing Internet standards in which case the procedures for
copyrights defined in the Internet Standards process must be
followed, or as required to translate it into languages other than
English.</p>
</div>
<div class="paragraph">
<p>The limited permissions granted above are perpetual and will not be
revoked by the Internet Society or its successors or assignees.</p>
</div>
<div class="paragraph">
<p>This document and the information contained herein is provided on an
"AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgement">Acknowledgement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Funding for the RFC Editor function is currently provided by the
Internet Society.</p>
</div>
<hr>
<hr>
<table class="tableblock frame-none grid-all" style="width: 99%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">END OF THE RFC</p></td>
</tr>
</tbody>
</table>
<hr>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_errata">Errata</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_reported">Reported</h3>
<div class="sect3">
<h4 id="_6014">6014</h4>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Errata ID: <a href="https://www.rfc-editor.org/errata/eid6014">6014</a><br>
Status: Reported<br>
Type: Editorial<br>
Publication Format(s) : TEXT<br>
Reported By: Andrea Grisotto<br>
Date Reported: 2020-03-10<br></p>
</div>
<div class="paragraph">
<p><a href="#errata_6014">Section 2.3.3.2</a> says:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>le attributes:</pre>
</div>
</div>
<div class="paragraph">
<p>It should say:</p>
</div>
<div class="literalblock">
<div class="content">
<pre><strong>Applicab</strong>le attributes:</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
</div>
</div>
<div id="footer">
    <div id="footer-text">
       <a href="https://gris8.github.io/betterfc" style="color:yellow">BetteRFC</a>
       document v1.0 created with
       <a href="https://www.asciidoctor.org" style="color:yellow">Asciidoctor</a>
       v2.0.11.dev
    </div>
</div>
</body>
</html>